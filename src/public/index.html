<head>
    <!-- webcomponents, polymer standard, polymer-ts -->
    <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="bower_components/polymer/polymer.html">
    <link rel="import" href="bower_components/paper-button/paper-button.html">
    <link rel="import" href="bower_components/iron-icon/iron-icon.html">
    <link rel="import" href="bower_components/iron-ajax/iron-ajax.html">
    <link rel="import" href="bower_components/vaadin-upload/vaadin-upload.html">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Slab:300,400" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <main-page></main-page>
</head>

<dom-module id="main-page">
    <style>
        :host {
            --primary-color: #00b0ff;
        }
        h1,h2,h3,h4,h5,h6 {
            margin: 0;
            font-family: 'Roboto', sans-serif;
        }
        #menu {
            width: 200px;
            position: absolute;
            left: 50%;
            top: 40%;
            margin-left: -100px;
            margin-top: -75px;
            text-align: center;
        }
        #menu-item {
            width: 400px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 370px;
            text-align: center;
        }
        #primary {
            margin: 45px;
            background-color: var(--primary-color);
            color: white;
        }
    </style>

    <template>
        <div id="menu">
            <h1>Triangularizer</h1>
        </div>
        <div id="menu-item">
            <vaadin-upload target="/"
                           method="POST"
                           headers="{'Accept': 'application/pdf'}"
                           timeout=15000
                           accept="application/pdf"
                           max-files="1"
                           on-upload-success="uploadSuccess"
                           on-upload-response="uploadResponse">
                <div class="drop-label">
                    <iron-icon icon="description"></iron-icon>
                    Upload a video to triangularize!
                </div>
            </vaadin-upload>
            <template is="dom-if" if="{{success}}">
                <paper-button raised id="primary" on-tap="callTriangular">Let's triangularize!</paper-button>
            </template>
        </div>
        <iron-ajax id="getTriVideo"
                   method="POST"
                   body="{{fileName}}"
                   url="/VideoToImages.py"
                   on-response="getVideo">
        </iron-ajax>
    </template>


    <script>
        Polymer({
            is: 'main-page',
            uploadResponse: function(e, file) {
                console.log(file.xhr.response);
                this.fileName = file.xhr.response;
                if (e.detail.xhr.status == 200) {
                    console.log("Code 200");
                }
                else {
                    console.log(e.detail.xhr.status);
                }
            },
            uploadSuccess: function(e) {
                this.success = true;
            },
            callTriangular: function() {
                console.log(this.$.getTriVideo.body);
                this.$.getTriVideo.generateRequest();
            },
            ready: function() {
            }
        });


    </script>

</dom-module>